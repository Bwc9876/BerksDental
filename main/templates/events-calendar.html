{% extends 'base.html' %}
{% comment %}
    This file is used to show the events for a month and year in a calendar
{% endcomment %}
{% block meta %}
    <title>Berks Dental Assistants: Events</title>
    <meta name="description" content="Berks Dental Assistants' Events Page.">
{% endblock %}
{% block links %}
    {% load static %}
    <link href="{% static "/events/shared.css" %}" type="text/css" rel="stylesheet">
    <link href="{% static "/events/calendar.css" %}" type="text/css" rel="stylesheet">
    <script type="text/javascript" src="{% static 'events/calendar.js' %}"></script>
{% endblock %}
{% block header %}
    <div class="hero is-small">
        <div class="hero-body">
            <a aria-label="Previous Month" href="{{ previous_link }}"><i class="is-size-4 icon fas fa-arrow-alt-circle-left"></i></a>
            <div class="center-text">
                <h1 class="title hero-title has-text-centered">{{ month_name }} {{ year }}</h1>
                <a class="is-link subtitle" href="{% url "main:events" %}?view=list">View As List</a>
            </div>
            <a aria-label="Next Month" href="{{ next_link }}"><i class="is-size-4 icon fas fa-arrow-alt-circle-right"></i></a>
        </div>
    </div>
{% endblock %}
{% block content %}
    <div class="box columns is-desktop">
        <div class="calendar column">
            {% for day in weekdays %}
                <div class="calendar-weekday"><p class="is-size-6 tile-content">{{ day }}</p></div>
            {% endfor %}
            {% load eventTags %}
            {% for week in weeks %}
                {% for day in week %}
                    {% makeDateObj as date %}
                    {% getEventsOnDate as eventsOnThisDate %}
                    <div data-berks-dental-event-date="{{ date|date:"mdY" }}" class="{% if day == 0 %}out-of-month{% else %}calendar-tile{% endif %} {% if eventsOnThisDate|length > 0 %}calendar-event calendar-tile{% endif %} {% if date == today %}calendar-today{% endif %}">
                    {% if day != 0 %}
                        <p class="tile-content is-size-5">{{ day }}</p>
                    {% endif %}
                    </div>
                {% endfor %}
            {% endfor %}
        </div>
        <div class="column content event-descriptions">
            <h2>Events:</h2>
            {% for week in weeks %}
                {% for day in week %}
                    {% if day != 0 %}
                        {% makeDateObj as date %}
                        {% getEventsOnDate as eventsOnThisDate %}
                        {% if eventsOnThisDate|length != 0 %}
                            <p class="event-descriptions-subtitle {{ date|date:"mdY" }}">{{ date }}</p>
                        {% else %}
                            <p class="event-descriptions-subtitle {{ date|date:"mdY" }}">There are no events on {{ date }}.</p>
                        {% endif %}
                        <div class="event-descriptions-list {{ date|date:"mdY" }}">
                            {% for event in eventsOnThisDate %}
                                <div class="card">
                                    <header class="card-header">
                                        <h3 class="card-header-title">{{ event.name }}</h3>
                                    </header>
                                    <div class="card-content">
                                        <div class="content">
                                            {% if event.startDate != event.endDate %}
                                                <p>Start Date & Time: {{ event.startDate }} at {{ event.startTime }}</p>
                                                <p>End Date & Time: {{ event.endDate }} at {{ event.endTime }}</p>
                                            {% else %}
                                                <p>Date & Time: {{ event.startDate }} at {{ event.startTime }}</p>
                                            {% endif %}
                                            {% if event.virtual %}
                                                <p>Link: <a href="{{ event.link }}">{{ event.link }}</a></p>
                                            {% else %}
                                                <p>Location: {{ event.location }}</p>
                                            {% endif %}
                                            <p>Description: {{ event.description }}</p>
                                        </div>
                                    </div>
                                </div>
                            {% endfor %}
                        </div>
                    {% endif %}
                {% endfor %}
            {% endfor %}
        </div>
    </div>
    <a class="view-switch-link" href="{% url "main:events" %}?view=list">View As List</a>
    <a class="view-switch-link" href="webcal://{{ request.get_host }}/{{ ics_link }}">Import To Your Calendar Software</a>
{% endblock %}